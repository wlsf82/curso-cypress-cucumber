# _Tags_

Uma funcionalidade bastante Ãºtil do Cucumber Ã© a possibilidade de colocar _tags_ nos cenÃ¡rios, e entÃ£o, executÃ¡-los por suas _tags_ especÃ­ficas.

Isso permite a criaÃ§Ã£o de abordagens como a definiÃ§Ã£o de quais cenÃ¡rios farÃ£o parte da suÃ­te de _smoke tests_ e quais farÃ£o parte dos testes de regressÃ£o, possibilitando a criaÃ§Ã£o de uma esteira de integraÃ§Ã£o contÃ­nua otimizada.

Nesta esteira de integraÃ§Ã£o contÃ­nua otimizada, primeiro, executamos uma suÃ­te de testes menor, sÃ³ com os testes mais importantes (os _smoke tests_).

E sÃ³ se os _smoke tests_ passam, radamos entÃ£o os cenÃ¡rios seguintes de regressÃ£o.

Ou seja, se a esteira falhar nos _smoke tests_, nÃ£o perdemos tempo esperando toda a bateria de regressÃ£o rodar, dando _feedback_ rÃ¡pido aos times.

Para definir tags com Cucumber, usamos a arroba - `@` (ex. `@smoke`).

Vejamos um exemplo.

```feature
# cypress/e2e/login.feature

Feature: Login
  Background: access the Login form
    Given I access the Login form

  @smoke
  Scenario: successful login
    When I submit it with valid credentials
    Then I see the logged-in features available

  Scenario: invalid password
    When I submit it with a valid user but an invalid password
    Then I am not allowed to login
    And I see an error message (The provided username or password are invalid!)

  Scenario: blocked user
    When I submit it with valid credentials of a blocked user
    Then I am not allowed to login
    And I see an error message (User locked out!)
```

> ğŸ‘¨â€ğŸ« Visto que o cenÃ¡rio de sucesso do login Ã© o mais importante, usamos a _tag_ `@smoke` nele.

## ConfiguraÃ§Ã£o extra para filtrar _tags_

Para filtrar os arquivos que precisam ser executados quando usando _tags_, basta adicionar a seguinte configuraÃ§Ã£o no arquivo `cypress.config.js`, dentro da propriedade `e2e`.

ğŸ™Š Assim:

```js
env: {
  omitFiltered: true,
  filterSpecs: true
},
```

> ğŸ‘¨â€ğŸ« Quando configurada como `true`, a propriedade `omitFiltered`, como o nome sugere, omite testes filtrados no _output_ da execuÃ§Ã£o dos testes na linha de comando.
>
> E a propriedade `filterSpecs` (tambÃ©m quando configurada como `true`) possibilita filtar os arquivos antes mesmo da execuÃ§Ã£o, otimizando a mesma, visto que somente arquivos que possuem certa tag sÃ£o executados.

## Executando testes por suas _tags_

Depois de adicionarmos _tags_ nos cenÃ¡rios, podemos entÃ£o rodar os testes por suas _tags_.

Para executar os testes que possuem certa _tag_, usamos o seguinte comando `npx cypress run --env tags='@tag-here'`

Para executar os testes que NÃƒO possuem certa _tag_, usamos o seguinte comando `npx cypress run --env tags='not @tag-here'`

> ğŸ‘¨â€ğŸ« Perceba a palavra **_not_**!

AlÃ©m disso, podemos definir _npm scripts_ no arquivo `package.json` para a execuÃ§Ã£o de tais comandos.

ğŸ™Š Algo assim:

```json
"scripts": {
  "test:smoke": "cypress run --env tags='@smoke'",
  "test:not:smoke": "cypress run --env tags='not @smoke'",
  "test:engagesphere": "cypress run --env tags='@engagesphere'",
  "test:hackerstories": "cypress run --env tags='@hackerstories'"
},
```

E em uma esteira de integraÃ§Ã£o contÃ­nua, podemos criar um fluxo onde primeiro os _smoke tests_ executam, e sÃ³ se passam, rodamos os _not smoke_ (o resto da suÃ­te de regressÃ£o).

## ExercÃ­cio ğŸ¯

1. Atualize os arquivos de _feature_ com _tags_ para experimentar

> ğŸ‘¨â€ğŸ« Recomendo escolher alguns testes para a suÃ­te de _smoke tests_, alÃ©m de adicionar _tags_ para as diferentes aplicaÃ§Ãµes (ğŸ™Š `@engagesphere` e `@hackerstories`).

2. Atualize a seÃ§Ã£o de `scripts` do arquivo `package.json` com atalhos para a execuÃ§Ã£o dos testes por suas diferentes _tags_
3. Atualize o arquivo `cypress.config.js` para que filtre os arquivos pela _tag_ sendo executada, conforme demonstrado acima
4. Por fim, execute os testes por suas diferentes _tags_ para experimentar.

## Mostre ao mundo o que vocÃª aprendeu ğŸŒ

Para mostrar Ã  sua rede profissional o que vocÃª aprendeu nesta aula, publique o seguinte no LinkedIn.

> Estou fazendo o curso "Testes End-to-End com Cypress e Cucumber: Guia Definitivo ğŸ¥’" da escola online Talking About Testing, onde aprendi a definir e executar cenÃ¡rios de teste por suas _tags_ especÃ­ficas. #TalkingAboutTesting #EscolaTAT #Cypress #Cucumber
>
> ğŸ‘¨â€ğŸ« Lembre-se de me marcar em sua publicaÃ§Ã£o. [Aqui estÃ¡ meu perfil no LinkedIn](https://www.linkedin.com/in/walmyr-lima-e-silva-filho).

___

Agora que vocÃª sabe usar _tags_, [vamos aprender como gerar um relatÃ³rio HTML de execuÃ§Ã£o dos testes](./11.md).

___

[Voltar para a pÃ¡gina inicial](../README.md)
